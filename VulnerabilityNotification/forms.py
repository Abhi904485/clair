from django.forms import CharField, TextInput, IntegerField, forms

from .models import VulnerabilityNotification


class VulnerabilityNotificationForm(forms.Form):
    id = IntegerField(label="Search By VN ID", required=False, widget=TextInput(
        attrs={
            'filter_field': 'id',
            'filter_method': '__exact',
            'placeholder': "1",
        }
    ))

    notification_name = CharField(label="Search By Notification name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'name',
            'filter_method': '__iexact',
            'placeholder': "4fb2ea0b-7e8d-4dfb-8fbf-a3ca6cfe447d",
        }
    ))

    created_at = CharField(label="Search By Notification Created At", required=False, widget=TextInput(
        attrs={
            'filter_field': 'created_at',
            'filter_method': '__date',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))
    created_at_before = CharField(label="Search By Notification Created Before", required=False, widget=TextInput(
        attrs={
            'filter_field': 'created_at',
            'filter_method': '__lte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    created_at_after = CharField(label="Search By Notification Created After", required=False, widget=TextInput(
        attrs={
            'filter_field': 'created_at',
            'filter_method': '__gte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    notified_at = CharField(label="Search By Notification notified At", required=False, widget=TextInput(
        attrs={
            'filter_field': 'notified_at',
            'filter_method': '__date',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    notified_at_before = CharField(label="Search By Notification notified Before", required=False, widget=TextInput(
        attrs={
            'filter_field': 'notified_at',
            'filter_method': '__lte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    notified_at_after = CharField(label="Search By Notification notified After ", required=False, widget=TextInput(
        attrs={
            'filter_field': 'notified_at',
            'filter_method': '__gte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    deleted_at = CharField(label="Search By Notification deleted at", required=False, widget=TextInput(
        attrs={
            'filter_field': 'deleted_at',
            'filter_method': '__date',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))
    deleted_at_before = CharField(label="Search By Notification deleted Before", required=False, widget=TextInput(
        attrs={
            'filter_field': 'deleted_at',
            'filter_method': '__lte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    deleted_at_after = CharField(label="Search By Notification deleted After", required=False, widget=TextInput(
        attrs={
            'filter_field': 'deleted_at',
            'filter_method': '__gte',
            'placeholder': "yyyy[y]-mm[mo]-dd[d] hh[h]:mm[m]:ss[s]",
        }
    ))

    old_vulnerability_name = CharField(label="Search By Old Vulnerability name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'old_vulnerability__name',
            'filter_method': '__iexact',
            'placeholder': "CVE-2016-7093 XSA-186",
        }
    ))

    new_vulnerability_name = CharField(label="Search By new Vulnerability name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'new_vulnerability__name',
            'filter_method': '__iexact',
            'placeholder': "CVE-2016-7093 XSA-186",
        }
    ))

    old_vulnerability_namespace_name = CharField(label="Search By Old vulnerability Namespace Name", required=False,
                                                 widget=TextInput(
                                                     attrs={
                                                         'filter_field': 'old_vulnerability__namespace__name',
                                                         'filter_method': '__exact',
                                                         'placeholder': "alpine:2.1.4",
                                                     }
                                                 ))

    new_vulnerability_namespace_name = CharField(label="Search By new vulnerability Namespace Name", required=False,
                                                 widget=TextInput(
                                                     attrs={
                                                         'filter_field': 'old_vulnerability__namespace__name',
                                                         'filter_method': '__exact',
                                                         'placeholder': "alpine:2.1.4",
                                                     }
                                                 ))

    old_vulnerability_severity_source = CharField(label="Search By Old Vulnerability Severity Source", required=False,
                                                  widget=TextInput(
                                                      attrs={
                                                          'filter_field': 'old_vulnerability__severity_source',
                                                          'filter_method': '__exact',
                                                          'placeholder': "debian:10, na , nvd",
                                                      }
                                                  ))

    new_vulnerability_severity_source = CharField(label="Search By New Vulnerability Severity Source", required=False,
                                                  widget=TextInput(
                                                      attrs={
                                                          'filter_field': 'new_vulnerability__severity_source',
                                                          'filter_method': '__exact',
                                                          'placeholder': "debian:10, na , nvd",
                                                      }
                                                  ))
    old_vulnerability_severity_source_is_null = CharField(label="Search By Old Vulnerability Severity Source is Null",
                                                          required=False,
                                                          widget=TextInput(
                                                              attrs={
                                                                  'filter_field': 'old_vulnerability__severity_source',
                                                                  'filter_method': '__isnull',
                                                                  'placeholder': "True, False (Case Doesn't matter)",
                                                              }
                                                          ))

    new_vulnerability_severity_source_is_null = CharField(label="Search By New Vulnerability Severity Source is Null",
                                                          required=False,
                                                          widget=TextInput(
                                                              attrs={
                                                                  'filter_field': 'new_vulnerability__severity_source',
                                                                  'filter_method': '__isnull',
                                                                  'placeholder': "True, False (Case Doesn't matter)",
                                                              }
                                                          ))

    class Meta:
        model = VulnerabilityNotification
        fields = '__all__'
        model._meta.fields[0].verbose_name = "VN ID"
