from django.forms import CharField, TextInput, IntegerField, forms

from .models import VulnerabilityFixedinFeature


class VulnerabilityFixedinFeatureForm(forms.Form):
    id = IntegerField(label="Search By VFIFV ID", required=False, widget=TextInput(
        attrs={
            'filter_field': 'id',
            'filter_method': '__exact',
            'placeholder': "1",
        }
    ))

    vulnerability_name = CharField(label="Search By Vulnerability name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'vulnerability__name',
            'filter_method': '__iexact',
            'placeholder': "CVE-2016-7093 XSA-186",
        }
    ))


    fixedin_feature_version = CharField(label="Search By FixedIn Feature Version", required=False, widget=TextInput(
        attrs={
            'filter_field': 'version',
            'filter_method': '__iexact',
            'placeholder': "1.1.1d-0+deb10u5",
        }
    ))
    feature_name = CharField(label="Search By Feature Name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'feature__name',
            'filter_method': '__iexact',
            'placeholder': "openssl",
        }
    ))

    namespace = CharField(label="Search By Namespace Name", required=False, widget=TextInput(
        attrs={
            'filter_field': 'feature__namespace__name',
            'filter_method': '__exact',
            'placeholder': "alpine:2.1.4",
        }
    ))

    namespace_version_format = CharField(label="Search By Namespace Version Format", required=False, widget=TextInput(
        attrs={
            'filter_field': 'feature__namespace__version_format',
            'filter_method': '__exact',
            'placeholder': "dpkg",
        }
    ))

    vulnerability_severity_source = CharField(label="Search By Vulnerability Severity Source", required=False,
                                              widget=TextInput(
                                                  attrs={
                                                      'filter_field': 'vulnerability__severity_source',
                                                      'filter_method': '__exact',
                                                      'placeholder': "debian:10, na , nvd",
                                                  }
                                              ))
    vulnerability_severity_source_is_null = CharField(label="Search By Null Vulnerability Severity Source", required=False,
                                                      widget=TextInput(
                                                          attrs={
                                                              'filter_field': 'vulnerability__severity_source',
                                                              'filter_method': '__isnull',
                                                              'placeholder': "True, False (Case Doesn't matter)",
                                                          }
                                                      ))

    class Meta:
        model = VulnerabilityFixedinFeature
        fields = '__all__'
        model._meta.fields[0].verbose_name = "VFIFV ID"
